apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-sync-vm
spec:
  provider: azure 
  vmIdentity: "true"
  keyVault: {{ .Values.keyVault.vaultName | quote}}
  tenantId: {{ .Values.keyVault.tenantId | quote}}
  objects: |
    array:
      - |
        objectName: {{ .Values.keyVault.accountName }}
        objectType: secret
        objectAlias: azurestorageaccountname
      - |
        objectName: {{ .Values.keyVault.accountKey }}
        objectType: secret    
        objectAlias: azurestorageaccountkey                 
  secretObjects:
    - data:
      - key: azurestorageaccountname
        objectName: azurestorageaccountname
      - key: azurestorageaccountkey
        objectName: azurestorageaccountkey
      secretName: {{ .Values.fileshare.vmSecretName | quote }}
      type: Opaque